<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dividend Discount Model Calculator - CFA Institute</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

  <!-- SKIP LINKS -->
  <nav aria-label="Skip links">
    <a href="#data-entry" class="skip-link">Skip to data entry</a>
    <a href="#results-card" class="skip-link">Skip to results</a>
    <a href="#visualization-card" class="skip-link">Skip to visualization</a>
  </nav>

  <!-- NOSCRIPT FALLBACK -->
  <noscript>
    <div class="card" style="margin:2rem auto;max-width:600px;">
      <h2 style="font-family:Georgia,serif;color:#06005a;">Dividend Discount Model Calculator</h2>
      <p><strong>JavaScript is required</strong> for the interactive version.</p>
    </div>
  </noscript>

  <div class="container">
    <main class="content">
      <h1 class="sr-only">Dividend Discount Model Calculator</h1>

      <!-- CARD 1 – Equation -->
      <section class="card" id="equation-card">
        <h2 class="card-title">Dividend Discount Models</h2>
        <p class="equation-intro">Three approaches to equity valuation</p>

        <div class="model-equations-grid">
          <!-- Constant Dividend Model -->
          <div class="formula-box" style="border-left-color:#2563eb;">
            <div class="formula-box-title">Constant Dividend Model</div>
            <div class="equation-container" tabindex="0" role="math"
                 aria-label="Price equals D zero divided by r">
              <div class="mathml-equation">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mi mathcolor="#2563eb" mathvariant="bold">P</mi>
                    <mo>=</mo>
                    <mfrac>
                      <msub><mi mathcolor="#92400e">D</mi><mn>0</mn></msub>
                      <mi mathcolor="#6b21a8">r</mi>
                    </mfrac>
                  </mrow>
                </math>
              </div>
              <div class="html-equation" hidden>
                <strong style="color:#2563eb;">P</strong> = 
                <span style="color:#92400e;">D₀</span> ÷ 
                <span style="color:#6b21a8;">r</span>
              </div>
            </div>
          </div>

          <!-- Constant Growth Model -->
          <div class="formula-box" style="border-left-color:#16a34a;">
            <div class="formula-box-title">Constant Growth Model (Gordon)</div>
            <div class="equation-container" tabindex="0" role="math"
                 aria-label="Price equals D one divided by r minus g">
              <div class="mathml-equation">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mi mathcolor="#15803d" mathvariant="bold">P</mi>
                    <mo>=</mo>
                    <mfrac>
                      <msub><mi mathcolor="#92400e">D</mi><mn>1</mn></msub>
                      <mrow>
                        <mi mathcolor="#6b21a8">r</mi>
                        <mo>−</mo>
                        <mi mathcolor="#c2410c">g</mi>
                      </mrow>
                    </mfrac>
                  </mrow>
                </math>
              </div>
              <div class="html-equation" hidden>
                <strong style="color:#15803d;">P</strong> = 
                <span style="color:#92400e;">D₁</span> ÷ 
                (<span style="color:#6b21a8;">r</span> − <span style="color:#c2410c;">g</span>)
              </div>
            </div>
          </div>

          <!-- Changing Growth Model -->
          <div class="formula-box" style="border-left-color:#9333ea;">
            <div class="formula-box-title">Changing Growth Model (Two-Stage)</div>
            <div class="equation-container" tabindex="0" role="math"
                 aria-label="Price equals present value of high growth dividends plus present value of terminal value">
              <div class="mathml-equation">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <mi mathcolor="#9333ea" mathvariant="bold">P</mi>
                    <mo>=</mo>
                    <mtext>PV(high growth) + PV(terminal)</mtext>
                  </mrow>
                </math>
              </div>
              <div class="html-equation" hidden>
                <strong style="color:#9333ea;">P</strong> = PV(high growth) + PV(terminal)
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- MIDDLE ROW -->
      <div class="middle-row">
        <!-- CARD 2 – Results -->
        <section class="card" id="results-card" tabindex="-1" aria-labelledby="results-title">
          <h3 class="card-title" id="results-title">Valuations</h3>
          
          <div id="results-content" aria-live="polite"></div>
          <div id="result-announcement" class="sr-only" aria-live="polite" aria-atomic="true"></div>
        </section>

        <!-- CARD 3 – Visualization -->
        <section class="card" id="visualization-card" tabindex="-1" aria-labelledby="visualization-title">
          <h3 class="card-title" id="visualization-title">Dividend Cash Flows</h3>
          
          <!-- View Toggle -->
          <div class="view-controls" role="group" aria-label="Select view type">
            <button id="view-chart-btn" class="toggle-btn active" aria-pressed="true">Chart</button>
            <button id="view-table-btn" class="toggle-btn" aria-pressed="false">Table</button>
          </div>

          <div id="chart-container" class="chart-wrapper">
            <canvas id="chart" tabindex="0" role="img" aria-label="Bar chart showing dividend cash flows"></canvas>
            <div id="chart-announcement" class="sr-only" aria-live="polite" aria-atomic="true"></div>
          </div>

          <div id="table-container" style="display:none;">
            <table id="data-table" class="data-table" tabindex="0" role="region" aria-label="Dividend cash flow data table">
              <!-- Table content populated by table.js -->
            </table>
          </div>
        </section>
      </div>

      <!-- CARD 4 – Data Entry -->
      <section class="card" id="data-entry" tabindex="-1" role="region" aria-labelledby="inputs-title">
        <h3 class="card-title" id="inputs-title">Data Entry</h3>

        <!-- Model Selector -->
        <div class="model-controls" role="group" aria-labelledby="model-selector-label">
          <span id="model-selector-label" class="sr-only">Select valuation model</span>
          <button id="model-all-btn" class="model-btn active" data-model="all" aria-pressed="true">All Models</button>
          <button id="model-constant-btn" class="model-btn" data-model="constant" aria-pressed="false">Constant</button>
          <button id="model-growth-btn" class="model-btn" data-model="growth" aria-pressed="false">Growth</button>
          <button id="model-changing-btn" class="model-btn" data-model="changing" aria-pressed="false">Two-Stage</button>
        </div>

        <div class="input-grid">
          <div class="input-row">
            <label for="D0" class="input-label-inline">Current Dividend (D₀):</label>
            <div class="input-wrapper prefix">
              <span class="input-prefix">$</span>
              <input type="number" id="D0" class="input-field-inline with-prefix"
                     min="0" max="1000" step="0.01" value="5"
                     aria-required="true"
                     aria-describedby="D0-help">
              <span id="D0-help" class="sr-only">The most recent annual dividend paid by the company</span>
            </div>
          </div>

          <div class="input-row">
            <label for="required" class="input-label-inline">Required Return (r):</label>
            <div class="input-wrapper suffix">
              <input type="number" id="required" class="input-field-inline"
                     min="0" max="50" step="0.1" value="10"
                     aria-required="true"
                     aria-describedby="required-help">
              <span class="input-suffix">%</span>
              <span id="required-help" class="sr-only">The minimum annual return investors expect from this stock</span>
            </div>
          </div>

          <div class="input-row">
            <label for="gConst" class="input-label-inline">Constant Growth (g):</label>
            <div class="input-wrapper suffix">
              <input type="number" id="gConst" class="input-field-inline"
                     min="-10" max="30" step="0.1" value="5"
                     aria-required="true"
                     aria-describedby="gConst-help">
              <span class="input-suffix">%</span>
              <span id="gConst-help" class="sr-only">Expected annual dividend growth rate for the Gordon Growth Model</span>
            </div>
          </div>

          <div class="input-row">
            <label for="gShort" class="input-label-inline">Short-term Growth:</label>
            <div class="input-wrapper suffix">
              <input type="number" id="gShort" class="input-field-inline"
                     min="-10" max="50" step="0.1" value="8"
                     aria-required="true"
                     aria-describedby="gShort-help">
              <span class="input-suffix">%</span>
              <span id="gShort-help" class="sr-only">High growth rate during the initial growth phase</span>
            </div>
          </div>

          <div class="input-row">
            <label for="gLong" class="input-label-inline">Long-term Growth:</label>
            <div class="input-wrapper suffix">
              <input type="number" id="gLong" class="input-field-inline"
                     min="-10" max="30" step="0.1" value="3"
                     aria-required="true"
                     aria-describedby="gLong-help">
              <span class="input-suffix">%</span>
              <span id="gLong-help" class="sr-only">Sustainable growth rate after the high growth phase ends</span>
            </div>
          </div>

          <div class="input-row">
            <label for="shortYears" class="input-label-inline">High Growth Period:</label>
            <div class="input-wrapper suffix">
              <input type="number" id="shortYears" class="input-field-inline"
                     min="1" max="10" step="1" value="5"
                     aria-required="true"
                     aria-describedby="shortYears-help">
              <span class="input-suffix">years</span>
              <span id="shortYears-help" class="sr-only">Number of years the company will grow at the high rate</span>
            </div>
          </div>
        </div>

        <div id="validation-summary" class="validation-summary" role="alert" aria-live="polite"
             style="display:none;">
          <div class="validation-title">Please correct the following:</div>
          <ul id="validation-list"></ul>
        </div>
      </section>

    </main>
  </div>

  <script type="module" src="./calculator.js"></script>
  <script type="module">
    if (!CSS.supports('math-style: normal')) {
      document.querySelectorAll('.mathml-equation').forEach(el => el.hidden = true);
      document.querySelectorAll('.html-equation').forEach(el => el.hidden = false);
    }
  </script>
</body>
</html>